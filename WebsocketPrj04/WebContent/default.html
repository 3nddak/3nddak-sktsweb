<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Chatroom</title>
<script type="text/javascript">
    var websocket = new WebSocket("ws://localhost:8080/WebsocketPrj02/chatroomserverendpoint");
     
    websocket.onmessage = function (message){
    	  var jsonData = JSON.parse(message.data);
    	  if(jsonData.message != null) messagesTextArea.value += jsonData.message + "\n";
    	  if(jsonData.users!=null){
    		  usersTextArea.value="";
    		  var i=0;
    		  while(i<jsonData.users.length) 
    			  usersTextArea.value += jsonData.users[i++]+"\n";
    	  }
    	 processMessage(message);};
     
     function sendMessage() {
        	 websocket.send(textMessage.value);
        	 textMessage.value="";
	}
     window.onbeforeunload = function(){
       	 websocket.onclose = function(){};
       	 websocket.close();
       	 };
    
   </script>
</head>
<body>
<form>
      <textarea id="messagesTextArea" rows="10" cols="50"></textarea><br/>
      <textarea id="usersTextArea" readonly="readonly" rows="10" cols="10"></textarea><br/>
      <input id="textMessage" type="text" size="50"/>
      <input type="button"  value="send" onclick="sendMessage();"/>
   </form>
   
</body>
</html>